<!DOCTYPE html>
<html lang="en" class="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WaveHeaven - Automatic Volume Adjustment</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            DEFAULT: '#3b82f6',
                            dark: '#60a5fa',
                        }
                    }
                }
            }
        }
    </script>
</head>

<body
    class="flex flex-col min-h-screen bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-200">
    <header class="px-4 lg:px-6 h-14 flex items-center">
        <a href="#" class="flex items-center justify-center">
            <i data-lucide="audio-waveform" class="h-6 w-6"></i>
            <span class="ml-2 text-lg font-bold">WaveHeaven</span>
        </a>
        <nav class="ml-auto flex gap-4 sm:gap-6">
            <a href="#features" class="text-sm font-medium hover:underline underline-offset-4">Features</a>
            <a href="#how-it-works" class="text-sm font-medium hover:underline underline-offset-4">How It Works</a>
            <a href="#demo" class="text-sm font-medium hover:underline underline-offset-4">Demo</a>
            <button id="darkModeToggle" class="text-sm font-medium hover:underline underline-offset-4">
                <i data-lucide="sun" class="h-5 w-5 dark:hidden"></i>
                <i data-lucide="moon" class="h-5 w-5 hidden dark:inline"></i>
                <span class="sr-only">Toggle mode</span>
            </button>
        </nav>
    </header>

    </header>
    <main class="flex-1">
        <section class="w-full py-12 md:py-24 lg:py-32 xl:py-48">
            <div class="container px-4 md:px-6">
                <div class="flex flex-col items-center space-y-4 text-center">
                    <div class="space-y-2">
                        <h1 class="text-3xl font-bold tracking-tighter sm:text-4xl md:text-5xl lg:text-6xl/none">
                            Welcome to WaveHeaven
                        </h1>
                        <p class="mx-auto max-w-[700px] text-gray-500 md:text-xl dark:text-gray-400">
                            Experience perfect sound with our intelligent automatic equalizer. Elevate your audio to new
                            heights.
                        </p>
                    </div>
                    <div class="space-x-4">
                        <button class="px-4 py-2 bg-blue-600 text-white rounded"
                            onclick="document.getElementById('demo').scrollIntoView({behavior: 'smooth'})">
                            Try Demo
                        </button>
                        <button onclick="connectToExtension()" class="px-4 py-2 bg-green-600 text-white rounded">
                            Connect to Audio Tab
                        </button>
                        <div id="more Information"
                            class="hidden mt-6 p-4 border border-gray-300 rounded-lg bg-white dark:bg-gray-800 text-left">
                            <p><strong>WaveHeaven</strong> is an innovative platform designed to transform your auditory
                                experience through automatic and personalized volume adjustments. Our system uses
                                cutting-edge technology to analyze the sound environment in real time, capturing data
                                through the Web Audio API to detect ambient volume and adapt it to your personal
                                preferences.</p>
                            <h2 class="mt-4 font-semibold">How does it work?</h2>
                            <ul class="list-disc pl-5">
                                <li><strong>Intelligent Volume Adjustment:</strong> WaveHeaven compares the ambient
                                    noise level with your stored ideal volume and calculates an optimal adjustment to
                                    provide a balanced audio experience regardless of the environment.</li>
                                <li><strong>Total Personalization:</strong> Stores your preferences, such as ideal
                                    volume, microphone status, and sound category (music, podcasts, or calls), so each
                                    session adapts to your needs.</li>
                                <li><strong>Browser Extension:</strong> In addition to the web application, WaveHeaven
                                    extends to other tabs through a Chrome extension. This allows you to control the
                                    volume of external pages (such as YouTube or Spotify) directly, ensuring a uniform
                                    auditory experience across all your platforms.</li>
                            </ul>
                            <h2 class="mt-4 font-semibold">Technologies Involved:</h2>
                            <ul class="list-disc pl-5">
                                <li><strong>Backend:</strong> Developed with Django, managing business logic and data
                                    persistence.</li>
                                <li><strong>Frontend:</strong> A modern and responsive interface built with Tailwind CSS
                                    and enriched with Lucide icons.</li>
                                <li><strong>Audio Processing:</strong> Implementation of the Web Audio API to capture
                                    and analyze the sound environment, along with the integration of a browser extension
                                    that facilitates real-time audio control.</li>
                            </ul>
                            <h2 class="mt-4 font-semibold">Advantages:</h2>
                            <ul class="list-disc pl-5">
                                <li><strong>Personalized Auditory Experience:</strong> WaveHeaven adapts to your needs,
                                    providing optimal sound without requiring manual intervention.</li>
                                <li><strong>Multiplatform Integration:</strong> From the web application to control in
                                    other tabs, enjoy a continuous and coherent audio experience.</li>
                                <li><strong>Innovation and Technology:</strong> We leverage the latest web technologies
                                    to offer you a robust, efficient, and easy-to-use product.</li>
                            </ul>
                            <p class="mt-4">Discover how WaveHeaven can transform the way you enjoy audio, making every
                                listening experience perfect, no matter the environment.</p>
                        </div>
                    </div>
                </div>
        </section>
        <main class="flex flex-col items-center text-center p-6">
            <h1 class="text-3xl font-bold mb-4">Learn more about WaveHeaven</h1>
            <p class="mb-6">An innovative platform for adaptive audio experiences.</p>
            <button id="more-info-btn" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600">More
                Information</button>
            <div id="more-info"
                class="hidden mt-6 p-4 border border-gray-300 rounded-lg bg-white dark:bg-gray-800 text-left">
                <p><strong>WaveHeaven</strong> is an innovative platform designed to transform your auditory experience
                    through automatic and personalized volume adjustments. Our system uses cutting-edge technology to
                    analyze the sound environment in real time, capturing data through the Web Audio API to detect
                    ambient volume and adapt it to your personal preferences.</p>
                <h2 class="mt-4 font-semibold">How does it work?</h2>
                <ul class="list-disc pl-5">
                    <li><strong>Intelligent Volume Adjustment:</strong> WaveHeaven compares the ambient noise level with
                        your stored ideal volume and calculates an optimal adjustment to provide a balanced audio
                        experience regardless of the environment.</li>
                    <li><strong>Total Personalization:</strong> Stores your preferences, such as ideal volume,
                        microphone status, and sound category (music, podcasts, or calls), so each session adapts to
                        your needs.</li>
                    <li><strong>Browser Extension:</strong> In addition to the web application, WaveHeaven extends to
                        other tabs through a Chrome extension. This allows you to control the volume of external pages
                        (such as YouTube or Spotify) directly, ensuring a uniform auditory experience across all your
                        platforms.</li>
                </ul>
                <h2 class="mt-4 font-semibold">Technologies Involved:</h2>
                <ul class="list-disc pl-5">
                    <li><strong>Backend:</strong> Developed with Django, managing business logic and data persistence.
                    </li>
                    <li><strong>Frontend:</strong> A modern and responsive interface built with Tailwind CSS and
                        enriched with Lucide icons.</li>
                    <li><strong>Audio Processing:</strong> Implementation of the Web Audio API to capture and analyze
                        the sound environment, along with the integration of a browser extension that facilitates
                        real-time audio control.</li>
                </ul>
                <h2 class="mt-4 font-semibold">Advantages:</h2>
                <ul class="list-disc pl-5">
                    <li><strong>Personalized Auditory Experience:</strong> WaveHeaven adapts to your needs, providing
                        optimal sound without requiring manual intervention.</li>
                    <li><strong>Multiplatform Integration:</strong> From the web application to control in other tabs,
                        enjoy a continuous and coherent audio experience.</li>
                    <li><strong>Innovation and Technology:</strong> We leverage the latest web technologies to offer you
                        a robust, efficient, and easy-to-use product.</li>
                </ul>
                <p class="mt-4">Discover how WaveHeaven can transform the way you enjoy audio, making every listening
                    experience perfect, no matter the environment.</p>
            </div>
        </main>
        <footer class="w-full bg-gray-800 text-white p-4 text-center mt-auto">
            © 2025 WaveHeaven. All rights reserved.
        </footer>
        </div>
        <script>
            document.getElementById("more-info-btn").addEventListener("click", function () {
                document.getElementById("more-info").classList.toggle("hidden");
            });
        </script>
</body>

</html>

<section id="features" class="w-full py-12 md:py-24 lg:py-32 bg-gray-100 dark:bg-gray-800">
    <div class="container px-4 md:px-6">
        <h2 class="text-3xl font-bold tracking-tighter sm:text-5xl text-center mb-12">Features</h2>
        <div class="grid gap-10 sm:grid-cols-2 md:grid-cols-3">
            <div class="flex flex-col items-center space-y-3 text-center">
                <i data-lucide="sliders" class="h-12 w-12 text-blue-600"></i>
                <h3 class="text-xl font-bold">Intelligent Equalization</h3>
                <p class="text-gray-500 dark:text-gray-400">Automatically adjusts audio settings for optimal
                    sound quality based on ambient noise and content type.</p>
            </div>
            <div class="flex flex-col items-center space-y-3 text-center">
                <i data-lucide="music" class="h-12 w-12 text-blue-600"></i>
                <h3 class="text-xl font-bold">Custom Manual Configuration</h3>
                <p class="text-gray-500 dark:text-gray-400">Fine-tune your audio experience with personalized
                    settings for different types of content and environments.</p>
            </div>
            <div class="flex flex-col items-center space-y-3 text-center">
                <i data-lucide="headphones" class="h-12 w-12 text-blue-600"></i>
                <h3 class="text-xl font-bold">Automatic Volume Adjustment</h3>
                <p class="text-gray-500 dark:text-gray-400">Dynamically adapts volume levels to maintain optimal
                    listening experience in changing environments.</p>
            </div>
        </div>
    </div>
</section>

<section id="how-it-works" class="w-full py-12 md:py-24 lg:py-32">
    <div class="container px-4 md:px-6">
        <h2 class="text-3xl font-bold tracking-tighter sm:text-5xl text-center mb-12">How It Works</h2>
        <div class="max-w-3xl mx-auto space-y-6">
            <p class="text-center text-lg text-gray-500 dark:text-gray-400">
                WaveHeaven uses advanced algorithms to analyze your audio environment and content in real-time.
                Here's how it enhances your listening experience:
            </p>
            <ol class="list-decimal list-inside space-y-4 text-left text-gray-500 dark:text-gray-400">
                <li><strong>Ambient Noise Detection:</strong> Our system constantly monitors the surrounding
                    noise levels.</li>
                <li><strong>Content Analysis:</strong> WaveHeaven identifies the type of audio you're listening
                    to (music, podcast, call, etc.).</li>
                <li><strong>Smart Adjustment:</strong> Based on the ambient noise and content type, it
                    automatically adjusts volume and equalizer settings.</li>
                <li><strong>User Preferences:</strong> The system learns from your manual adjustments to
                    personalize the audio experience over time.</li>
                <li><strong>Real-time Adaptation:</strong> As your environment changes, WaveHeaven continuously
                    optimizes your audio settings.</li>
            </ol>
        </div>
    </div>
</section>

<section id="demo" class="w-full py-12 md:py-24 lg:py-32">
    <div class="container px-4 md:px-6">
        <h2 class="text-3xl font-bold tracking-tighter sm:text-5xl text-center mb-12">WaveHeaven Demo</h2>
        <div class="max-w-2xl mx-auto space-y-6">
            <p class="text-center text-lg text-gray-500 dark:text-gray-400">
                Experience real-time automatic volume adjustment.
            </p>
            <div class="flex flex-col items-center space-y-4">
                <p id="ambientVolumeDisplay" class="text-xl font-semibold">Ambient Volume: --</p>
                <div class="space-x-4">
                    <button onclick="startListening()"
                        class="px-4 py-2 bg-blue-600 text-white rounded flex items-center">
                        <i data-lucide="mic" class="mr-2 h-4 w-4"></i>
                        Activate Microphone
                    </button>
                    <button onclick="stopListening()"
                        class="px-4 py-2 border border-gray-300 rounded flex items-center">
                        <i data-lucide="mic-off" class="mr-2 h-4 w-4"></i>
                        Deactivate Microphone
                    </button>
                </div>
                <p class="text-lg">Tab Volume: <span id="tabVolumeDisplay" class="font-semibold">100%</span></p>
            </div>
        </div>
        <div class="flex flex-col items-center space-y-4 mt-8">
            <label class="text-lg font-semibold">Sound Profile:</label>
            <select id="soundCategory" class="px-4 py-2 border rounded">
                <option value="music">Music</option>
                <option value="podcast">Podcasts</option>
                <option value="call">Calls</option>
            </select>
            <button onclick="updateSoundCategory()" class="px-4 py-2 bg-blue-600 text-white rounded">
                Apply Category
            </button>
        </div>
    </div>
    <progress id="volumeBar" value="1" max="1" class="w-full mt-8"></progress>
</section>

<section id="cta" class="w-full py-12 md:py-24 lg:py-32 bg-blue-600 text-white">
    <div class="container px-4 md:px-6">
        <div class="flex flex-col items-center space-y-4 text-center">
            <div class="space-y-2">
                <h2 class="text-3xl font-bold tracking-tighter sm:text-5xl">Experience WaveHeaven Today</h2>
                <p
                    class="mx-auto max-w-[600px] text-blue-100 md:text-xl/relaxed lg:text-base/relaxed xl:text-xl/relaxed">
                    Transform your listening experience with our cutting-edge automatic equalizer. Stay tuned
                    for our launch!
                </p>
            </div>
            <div class="w-full max-w-sm space-y-2">
                <button
                    class="w-full px-8 py-3 bg-white text-blue-600 rounded-full text-lg font-semibold flex items-center justify-center"
                    disabled>
                    <i data-lucide="zap" class="mr-2 h-5 w-5"></i>
                    Coming Soon
                </button>
            </div>
        </div>
    </div>
</section>
</main>

<footer class="flex flex-col gap-2 sm:flex-row py-6 w-full shrink-0 items-center px-4 md:px-6 border-t">
    <p class="text-xs text-gray-500">© 2025 WaveHeaven. All rights reserved.</p>
    <nav class="sm:ml-auto flex gap-4 sm:gap-6">
        <a class="text-xs hover:underline underline-offset-4" href="#">Terms of Service</a>
        <a class="text-xs hover:underline underline-offset-4" href="#">Privacy Policy</a>
    </nav>
</footer>

<script>
    let audioContext;
    let analyser;
    let microphone;
    let dataArray;
    let isListening = false;
    let ambientVolumeDisplay = document.getElementById("ambientVolumeDisplay");
    let activeTabId = null;
    let globalAudioContext = new (window.AudioContext || window.webkitAudioContext)();
    let gainNode = globalAudioContext.createGain(); // Controlador de volumen


    // Inicializar los iconos de Lucide
    lucide.createIcons();

    async function captureAudioFromTabs() {
        try {
            const stream = await navigator.mediaDevices.getDisplayMedia({ video: true, audio: true });
            const audioTrack = stream.getAudioTracks()[0];

            if (!audioTrack) {
                throw new Error("No se detectó audio en la pestaña seleccionada.");
            }

            const audioSource = globalAudioContext.createMediaStreamSource(new MediaStream([audioTrack]));
            audioSource.connect(gainNode).connect(globalAudioContext.destination);

            console.log("Capturando audio de la pestaña activa...");
        } catch (error) {
            console.error("No se pudo capturar el audio de la pestaña:", error);
            alert("Asegúrate de compartir una pestaña con audio cuando se te pida.");
        }
    }

    async function startListening() {
        if (isListening) return;
        isListening = true;

        try {
            const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
            audioContext = new AudioContext();
            analyser = audioContext.createAnalyser();
            microphone = audioContext.createMediaStreamSource(stream);
            microphone.connect(analyser);
            analyser.fftSize = 256;
            dataArray = new Uint8Array(analyser.frequencyBinCount);
            analyzeAudio();

            await captureAudioFromTabs();
        } catch (error) {
            console.error("Error accessing microphone:", error);
            alert("No se pudo acceder al micrófono. Verifica los permisos.");
        }
    }

    function stopListening() {
        if (!isListening) return;
        isListening = false;
        if (audioContext) {
            audioContext.close();
        }
        ambientVolumeDisplay.textContent = "Ambient Volume: --";
    }

    function analyzeAudio() {
        if (!isListening) return;
        analyser.getByteFrequencyData(dataArray);

        let volume = dataArray.reduce((sum, val) => sum + val, 0) / dataArray.length;

        ambientVolumeDisplay.textContent = `Volumen Ambiental: ${volume.toFixed(2)}`;

        adjustVolumeBasedOnAmbient(volume);

        requestAnimationFrame(analyzeAudio);
    }

    function updateSoundCategory() {
        const category = document.getElementById('soundCategory').value;
        fetch('/set_sound_category/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCookie('csrftoken'),
            },
            body: JSON.stringify({ category: category }),
        })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    alert('Updated category: ' + data.category);
                }
            })
            .catch(error => console.error('Error:', error));
    }

    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.startsWith(name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }

    async function connectToExtension() {
        window.postMessage({ type: "CONNECT_TO_TAB", data: {} }, "*");
    }

    function adjustVolumeBasedOnAmbient(ambientVolume) {
        let newVolume;
        const categoryElement = document.getElementById('soundCategory');
        if (!categoryElement) return;
        const category = categoryElement.value;

        switch (category) {
            case 'music':
                newVolume = ambientVolume > 50 ? Math.max(0.3, 1.0 - (ambientVolume - 50) / 80) : 1.0;
                break;
            case 'podcast':
                newVolume = ambientVolume > 50 ? Math.max(0.4, 0.8 - (ambientVolume - 50) / 120) : 0.8;
                break;
            case 'call':
                newVolume = ambientVolume > 50 ? Math.max(0.5, 1.2 - (ambientVolume - 50) / 90) : 1.0;
                break;
            default:
                newVolume = 1.0;
        }

        newVolume = Math.max(0, Math.min(1, newVolume));

        console.log(`Ambient Volume: ${ambientVolume}, Adjusted Volume: ${newVolume}`);

        window.postMessage({ type: "WH_ADJUST_VOLUME", volume: newVolume }, "*");

        const volumeDisplay = document.getElementById("tabVolumeDisplay");
        if (volumeDisplay) {
            volumeDisplay.textContent = `${Math.round(newVolume * 100)}%`;
            volumeDisplay.style.color = newVolume < 0.5 ? 'red' : 'green';
        }

        gainNode.gain.cancelScheduledValues(globalAudioContext.currentTime);
        gainNode.gain.setTargetAtTime(newVolume, globalAudioContext.currentTime, 0.5);

        const volumeBar = document.getElementById("volumeBar");
        if (volumeBar) {
            volumeBar.setAttribute("value", newVolume);
        }

        if (activeTabId) {
            chrome.runtime.sendMessage({
                type: "adjustVolume",
                volume: newVolume,
                tabId: activeTabId
            }, (response) => {
                if (response && response.status === "success") {
                    console.log("Volumen ajustado en la pestaña:", activeTabId);
                } else {
                    console.error("Error al ajustar el volumen en la pestaña.");
                }
            });
        }
    }

    // Dark mode toggle functionality
    function setTheme(isDark) {
        if (isDark) {
            document.documentElement.classList.add('dark');
            localStorage.setItem('theme', 'dark');
        } else {
            document.documentElement.classList.remove('dark');
            localStorage.setItem('theme', 'light');
        }
    }

    // Check for saved theme preference or use system preference
    const savedTheme = localStorage.getItem('theme');
    const systemDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches;

    if (savedTheme === 'dark' || (!savedTheme && systemDarkMode)) {
        setTheme(true);
    }

    document.getElementById('darkModeToggle').addEventListener('click', () => {
        const isDark = document.documentElement.classList.toggle('dark');
        setTheme(isDark);
    });
</script>
</body>

</html>